<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <%- include('partials/header') %>
    
    <main class="soumettre-besoin-page">
        <div class="form-container">
            <h1>Signaler un besoin local</h1>
            <p class="subtitle">Votre territoire a besoin de vous. Partagez ce qui manque dans votre quartier.</p>
            
            <form id="besoinForm" class="besoin-form">
                <div class="form-group">
                    <label for="type">Type de besoin *</label>
                    <select id="type" name="type" required>
                        <option value="">Sélectionnez une catégorie</option>
                        <option value="commerce">Commerce / Artisanat</option>
                        <option value="social">Social / Solidarité</option>
                        <option value="environnement">Environnement</option>
                        <option value="culture">Culture</option>
                        <option value="education">Éducation</option>
                        <option value="sport">Sport / Loisirs</option>
                        <option value="autre">Autre</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="titre">Titre du besoin *</label>
                    <input type="text" id="titre" name="titre" required 
                           placeholder="Ex: Librairie indépendante">
                </div>
                
                <div class="form-group">
                    <label for="description">Description *</label>
                    <textarea id="description" name="description" required rows="5"
                              placeholder="Décrivez le besoin de manière claire et précise..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="urgence">Niveau d'urgence</label>
                    <select id="urgence" name="urgence">
                        <option value="basse">Basse</option>
                        <option value="moyenne" selected>Moyenne</option>
                        <option value="haute">Haute</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="auteur">Votre nom (optionnel)</label>
                    <input type="text" id="auteur" name="auteur" 
                           placeholder="Ex: Marie Dupont">
                </div>
                
                <div class="form-group">
                    <label>Localisation *</label>
                    <div id="mapPicker" class="map-picker"></div>
                    <p class="help-text">Cliquez sur la carte pour positionner le besoin</p>
                    <input type="hidden" id="lat" name="lat">
                    <input type="hidden" id="lon" name="lon">
                    <div id="addressDisplay" class="address-display"></div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="window.location.href='/'">
                        Annuler
                    </button>
                    <button type="submit" class="btn-primary">
                        Soumettre le besoin
                    </button>
                </div>
            </form>
            
            <div id="successMessage" class="success-message hidden">
                <h3> Besoin soumis avec succès !</h3>
                <p>Merci pour votre contribution au territoire.</p>
                <button onclick="window.location.href='/carte'" class="btn-primary">
                    Voir sur la carte
                </button>
            </div>
        </div>
    </main>
    
    <%- include('partials/footer') %>
    
    <script src="/js/soumettre-besoin.js"></script>
</body>
</html>
